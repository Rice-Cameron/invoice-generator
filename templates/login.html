{% extends "base.html" %}

{% block title %}Login{% endblock %}

{% block content %}
<div class="auth-container">
  <div class="auth-card">
    <h2>Login to Your Account</h2>
    <p>Welcome back! Please enter your credentials.</p>
    <form method="post" action="{% url 'login' %}" class="secure-form">
      <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">
      <div class="form-group">
        <label for="id_username">Email:</label>
        <input 
          type="email" 
          name="username" 
          id="id_username" 
          class="form-control" 
          required
          autocomplete="off"
          oncopy="return false;"
          oncut="return false;"
          onpaste="return false;"
        />
      </div>
      <div class="form-group">
        <label for="id_password">Password:</label>
        <input 
          type="password" 
          name="password" 
          id="id_password" 
          class="form-control" 
          required
          autocomplete="off"
          oncopy="return false;"
          oncut="return false;"
          onpaste="return false;"
          oncontextmenu="return false;"
          onselectstart="return false;"
        />
      </div>
      <button type="submit" class="btn-auth">Login</button>
    </form>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const passwordInput = document.getElementById('id_password');
        const securityInfo = document.querySelector('.security-info');
        
        // Mask password input
        passwordInput.addEventListener('input', function() {
            this.value = this.value.replace(/\s/g, '');
        });
        
        // Add security indicators
        const securityIndicators = {
            'encrypted': false,
            'secure': false
        };
        
        // Check if connection is secure
        if (window.location.protocol === 'https:') {
            securityIndicators.secure = true;
        }
        
        // Update security info
        function updateSecurityInfo() {
            const secureIcon = securityInfo.querySelector('.fas.fa-shield-alt');
            if (securityIndicators.secure) {
                secureIcon.style.color = '#28a745';
            } else {
                secureIcon.style.color = '#dc3545';
            }
        }
        
        updateSecurityInfo();
    });
    </script>
    </form>
    <div class="auth-switch">
      <p>
        Don't have an account? <a href="{% url 'register' %}">Sign up here</a>.
      </p>
    </div>
  </div>
</div>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const passwordInput = document.getElementById("id_password");
    passwordInput.addEventListener("input", function () {
      // Mask password input
      this.value = this.value.replace(/[\s]/g, "");
    });
  });
</script>
{% endblock %}